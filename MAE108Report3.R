# Script created by Sam Hince
# 10/28/2020

library(dplyr)
library(ggplot2)
library(MASS) # to access Animals data sets
library(scales) # to access break formatting functions

###########################################################################################

# online desnsity calculator: https://www.omnicalculator.com/physics/air-density
rho = 1.17279 # kg / m^3
viscosity = 18.45*(10^-6)

chord = 0.061 # 61 (mm)
span = 0.257 # 257 (mm)
A = chord * span

###########################################################################################
# Question 3: For the clean airfoil configuration plot, on a single plot, cl versus 
# 				corrected angle of attack for the three test speeds.  

# calibration numbers
#aoa <- c(-8,-6,-4,-2,0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30)
#Fx <- c(-1.46804,-1.47312,-1.48053,-1.48216,-1.47701,-1.47442,-1.47234,-1.46904,-1.45681,
#		-1.44723,-1.43406,-1.42372,-1.40456,-1.39081,-1.37318,-1.351,-1.32738,-1.30226,
#		-1.27675,-1.27675)
#Fz <- c(-2.57659,-2.63442,-2.69745,-2.77846,-2.88202,-2.93373,-2.99059,-3.04139,-3.09796,
#		-3.13129,-3.18543,-3.21783,-3.2635,-3.25604,-3.24901,-3.26621,-3.31875,-3.31109,
#		-3.36873,-3.36873)


#aoa <- c(
#	-3.77544938413365,
#	-0.377995776824753,
#	4.94192906427867,
#	7.01538222386539,
#	12.1599796521173,
#	17.065376940449,
#	18.1663823790781,
#	25.3226372018242,
#	28.1844130190183,
#	29.9859586726403,
#	32.0824125830047,
#	24.1196927884345,
#	22.2998039825171,
#	18.8781055482468,
#	12.8708194473109,
#	10.3043602150186,
#	6.69228935307356,
#	1.40170962291147,
#	-2.55876818734084,
#	-4.62502542552439,
#	1.48991486747582
#)
#Fx <- c(-0.03411,0.22371,0.44737,0.575975,0.643503,0.762648,0.891588,1.026681,1.137245,    #lift
#		1.285035,1.194433,1.050701,0.884398,0.744954,0.605834,0.476371,0.31134,0.1745,
#		-0.07668,-0.34511,-1.47585) 
#Fz <- c(-2.721,-2.83677,-2.9509,-3.07232,-3.18971,-3.29999,-3.40131,-3.56405,-3.52057,     #drag
#		-3.57429,-3.60924,-3.53526,-3.41617,-3.3914,-3.2807,-3.15153,-3.02338,-2.92275,
#		-2.81749,-2.70257,-2.78738)

#L <- (Fx * cos(aoa*pi/180)) - (Fz * sin(aoa*pi/180))
#
#dynamicPressure <- ((10^2) * 0.5 * rho)
#
#Cl = L/(dynamicPressure * A)
#





#L <- (Fx * cos(aoa*pi/180)) + (Fz * sin(aoa*pi/180))
#D <- (Fx * sin(aoa*pi/180)) + (Fz * cos(aoa*pi/180))

#Drag0 <- -0.0181225 # N
#dynamicPressure <- ((10^2) * 0.5 * rho)

#Cl = L/(dynamicPressure * A)

# 20 m/s
#aoa <- c(-4,0,4,8,12,16,20,24,22,18,14,10,6,2,-2,-6,-4)
#Fx <- c(-0.962373,-0.0178273,1.11691,2.01314,2.01404,2.38054,2.09885,2.37995,2.66004,
#		2.48684,1.6603,2.47189,1.65615,0.597499,-0.504352,-1.43755,-1.02606)
#Fz <- c(-2.87322,-2.91808,-2.75606,-2.59446,-2.87537,-2.27961,-2.45926,-2.20247,-3.05567,
#		-2.86314,-3.02781,-2.44304,-2.71738,-2.8017,-2.77841,-2.7767,-2.85665)

# 30 m/s
#aoa <- c(-4,0,4,8,12,16,20,24,22,18,14,10,6,2,-2,-6,-4)
#Fx <- c(-0.730619,0.872336,2.76487,4.10705,4.98186,5.09122,4.78878,4.97019,5.20539,4.7285,
#		4.62891,4.86196,3.65049,1.86597,0.0741441,-1.28805,-0.633635)
#Fz <- c(-2.7895,0.872336,-2.63626,-2.29676,-1.8889,-2.38128,-2.91517,-3.316,-3.20051,
#		-2.89337,-2.48196,-2.08783,-2.5# Finally, plot corrected Cm, ac versus corrected angle  of  attack  for  the  three  


###########################################################################################
# Question 3: For the clean airfoil configuration plot, on a single plot, cl versus 
# 				corrected angle of attack for the three test speeds. 


# 10 m/s
aoa <- c(-4.04335715184129,
		 0.425163522635601,
		 4.81323086505135,
		 9.01190778392168,
		 13.0989979007967,
		 17.2628039852576,
		 21.4883122065077,
		 25.6966927714181,
		 29.7119159806454,
		 33.9381319680238,
		 31.9024570689655,
		 27.7437419446855,
		 23.5439555239591,
		 19.4016234647782,
		 15.2181168737576,
		 11.0599508627,
		 6.83806503969342,
		 2.64646081415771,
		 -1.76221954053398,
		 -6.28963574086728,
		 -4.00299744006178)

Cl <- c(-0.025504206965467,
		0.250096189785647,
		0.478371097089028,
		0.595239872895107,
		0.646469353409804,
		0.742825873680962,
		0.875477768533927,
		0.99805457142244,
		1.00700940037964,
		1.14007762824928,
		1.11909239350913,
		1.02573055569735,
		0.908209131740652,
		0.824484391045977,
		0.716539337504459,
		0.623500507470576,
		0.492979435113777,
		0.380271067151592,
		0.139870858509421,
		-0.170373965216046,
		-0.001763200036342)

Cd <- c(-0.024137952185433,
		0.051598994037366,
		0.084035626917158,
		0.12273598934343,
		0.145140873972498,
		0.187843020890965,
		0.163547845599634,
		0.179191439282702,
		0.376891382840261,
		0.421539029270411,
		0.37851249971423,
		0.257781831978413,
		0.213962314328245,
		0.131890903269866,
		0.122857137122425,
		0.099018912359702,
		0.079004222455876,
		0.029690168261829,
		-0.047211384775875,
		-0.056520656719594,
		-0.098936679633615)

Cm <- c(-0.039482113322101,
		0.498825176445005,
		0.982311831541085,
		1.23647903173166,
		1.36222352466176,
		1.58424616405605,
		1.9343779400167,
		2.24941291989308,
		2.20881583962017,
		2.55158635772187,
		2.49929123834412,
		2.29400022491816,
		2.00144108443538,
		1.81688399251457,
		1.54546465846815,
		1.32387194437242,
		1.02614365004139,
		0.793426819911334,
		0.317844504906616,
		-0.317514594385578,
		0.050426685695478)

df10 <- data.frame(Cl, Cd, Cm, aoa)

### 20 m/s



aoa <- c(-3.764332335657,
		 0.681449095892934,
		 5.19861308786867,
		 9.571996838677,
		 13.5940734639307,
		 17.5725421998526,
		 21.3975338700745,
		 25.3696310846692,
		 23.6999544461587,
		 19.6655591970174,
		 15.3760099037848,
		 11.7466386277082,
		 7.43567485483473,
		 2.9648601683855,
		 -1.54363380360614,
		 -5.99042502509349,
		 -3.79346238680975)

Cl <- c(0.138628037848826,
		0.400852409348784,
		0.705066522275686,
		0.924704022751176,
		0.937690272900384,
		0.925024823442733,
		0.822078747102659,
		0.805665343923052,
		0.999973203622796,
		0.979740704127907,
		0.809417590461624,
		1.02743448688716,
		0.844514620491015,
		0.567564804932649,
		0.268450703761097,
		0.005632338180301,
		0.121492713641323)
		
Cd <- c(-0.057521010219734,
		-0.005085571128534,
		0.128801733543812,
		0.295286916316708,
		0.227557747071651,
		0.572093690538583,
		0.550362521005818,
		0.713852301364139,
		0.496393535097141,
		0.4606219607891,
		0.275263658355144,
		0.404819081677315,
		0.199657357709264,
		0.065775793268841,
		-0.007198787851739,
		-0.039892097214393,
		-0.051893445388945)

Cm <- c(0.318114923064384,
		0.848856748466581,
		1.44773850101221,
		1.86825578174875,
		1.97103867196707,
		1.79272125604396,
		1.60479641334903,
		1.51754233200073,
		2.06793663104964,
		1.99845162067926,
		1.67273520995365,
		2.05560652012751,
		1.7272844642938,
		1.17412773519455,
		0.564811399573812,
		0.033205465741358,
		0.279569858997767)

df20 <- data.frame(Cl, Cd, Cm, aoa)

### 25 m/s

aoa <- c(-3.77832820637742,
		 0.702183635325032,
		 5.25596489444203,
		 9.61344174179131,
		 13.7951473962895,
		 17.7935987852144,
		 21.6965200177166,
		 25.7191843284208,
		 23.8095579108586,
		 19.7059558445149,
		 15.702094104125,
		 11.8029157958044,
		 7.50524312963528,
		 2.99685771607508,
		 -1.53650930769154,
		 -5.95118901493656,
		 -3.75213280293476)

Cl <- c(0.130395172719164,
		0.413049197250019,
		0.738802879083544,
		0.9490833775243,
		1.05596905664086,
		1.05505810894967,
		0.997952951597998,
		1.01128489907103,
		1.06444582991681,
		1.00350343794993,
		1.0012318259559,
		1.06053870341433,
		0.885437135079574,
		0.586386891808872,
		0.272641583710858,
		0.028712344154963,
		0.145804233567786)

Cd <- c(-0.027753443621957,
		0.427631595307453,
		0.33699345872054,
		0.869054965929612,
		1.34227138352554,
		1.06433052762904,
		0.440020561929713,
		0.034167412771897,
		0.120379754294521,
		0.472538591142714,
		0.869892958651424,
		1.17296737425851,
		0.570168754124898,
		0.077955431478122,
		-0.057173196295574,
		-0.041093532122895,
		-0.071261700700899)

Cm <- c(0.284803968540829,
		0.636385694313853,
		1.40585974672502,
		1.60601242537623,
		1.62746318721664,
		1.82430079553642,
		2.07215116219558,
		2.35605198039979,
		2.41694627140923,
		2.04690657122199,
		1.7841446898281,
		1.70752523282655,
		1.61241339040928,
		1.20773088270567,
		0.601018667308822,
		0.081108649260348,
		0.340481576491729)

df25 <- data.frame(Cl, Cd, Cm, aoa)

###
coloursMap <- c("10 m/s" = "#3734eb", "20 m/s" = "#34b7eb", "25 m/s" = "#34ebc9")

pl1 <- ggplot() +
	geom_line(data = df10, aes(x = aoa, y = Cl, colour = "10 m/s"), size=1.5) + 
	geom_line(data = df20, aes(x = aoa, y = Cl, colour = "20 m/s"), size=1.5) + 
	geom_line(data = df25, aes(x = aoa, y = Cl, colour = "25 m/s"), size=1.5) +
	xlab(expression(alpha)) +
	ylab(expression(C[l])) +
	scale_colour_manual(values = coloursMap) + 
	theme_bw() +
	theme(axis.title.y = element_text(angle = 0, vjust = 0.5, size = 12),
		  axis.title.x = element_text(size = 15),
		  legend.position = c(.95, .25),
		  legend.justification = c("right", "top"),
		  legend.box.just = "right",
		  legend.margin = margin(6, 6, 6, 6),
		  legend.box.background = element_rect(color="black", size=1))
print(pl1)


#####################################################################################################3
# On another figure, plot corrected CD versus corrected angle of attack for the three 
#				test speeds.  
coloursMap <- c("10 m/s" = "#3734eb", "20 m/s" = "#34b7eb", "25 m/s" = "#34ebc9")

pl2 <- ggplot() + 
	geom_line(data = df10, aes(x = aoa, y = Cd, colour = "10 m/s"), size=1.5) + 
	geom_line(data = df20, aes(x = aoa, y = Cd, colour = "20 m/s"), size=1.5) +
	geom_line(data = df25, aes(x = aoa, y = Cd, colour = "25 m/s"), size=1.5) + 
	xlab(expression(alpha)) +
	ylab(expression(C[d])) +
	scale_colour_manual(values = coloursMap) + 
	theme_bw() +
	theme(axis.title.y = element_text(angle = 0, vjust = 0.5, size = 12),
		axis.title.x = element_text(size = 15),
		legend.position = c(.95, .95),
		legend.justification = c("right", "top"),
		legend.box.just = "right",
		legend.margin = margin(6, 6, 6, 6),
		legend.box.background = element_rect(color="black", size=1))
print(pl2)

#####################################################################################################
# Finally, plot corrected Cm, ac versus corrected angle  of  attack  for  the  three  
#				test  speeds. This  will  produce  three  plots  with  three curves each.

pl3 <- ggplot() + 
	geom_line(data = df10, aes(x = aoa, y = Cm, colour = "10 m/s"), size=1.5) + 
	geom_line(data = df20, aes(x = aoa, y = Cm, colour = "20 m/s"), size=1.5) +
	geom_line(data = df25, aes(x = aoa, y = Cm, colour = "25 m/s"), size=1.5) + 
	xlab(expression(alpha)) +
	ylab(expression(C[m])) +
	scale_colour_manual(values = coloursMap) + 
	theme_bw() +
	theme(axis.title.y = element_text(angle = 0, vjust = 0.5, size = 12),
		  axis.title.x = element_text(size = 15),
		  legend.position = c(.95, .25),
		  legend.justification = c("right", "top"),
		  legend.box.just = "right",
		  legend.margin = margin(6, 6, 6, 6),
		  legend.box.background = element_rect(color="black", size=1))
print(pl3)

#####################################################################################################

