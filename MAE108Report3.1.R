# Script created by Sam Hince
# 11/17/2020

library(dplyr)
library(ggplot2)
library(MASS) # to access Animals data sets
library(scales) # to access break formatting functions
#####################################################################################################

# Plot CL, corrected CD, and Cmac, versus corrected α for the clean, slat, 45◦ flap, and flap/slat 
# configurations at 20m/son three plots.  This will result in three plots with four curves each.

#### data
# clean
aoa <- c(-3.764332335657,
		 0.681449095892934,
		 5.19861308786867,
		 9.571996838677,
		 13.5940734639307,
		 17.5725421998526,
		 21.3975338700745,
		 25.3696310846692,
		 23.6999544461587,
		 19.6655591970174,
		 15.3760099037848,
		 11.7466386277082,
		 7.43567485483473,
		 2.9648601683855,
		 -1.54363380360614,
		 -5.99042502509349,
		 -3.79346238680975)

Cl <- c(0.138628037848826,
		0.400852409348784,
		0.705066522275686,
		0.924704022751176,
		0.937690272900384,
		0.925024823442733,
		0.822078747102659,
		0.805665343923052,
		0.999973203622796,
		0.979740704127907,
		0.809417590461624,
		1.02743448688716,
		0.844514620491015,
		0.567564804932649,
		0.268450703761097,
		0.005632338180301,
		0.121492713641323)

Cd <- c(-0.057521010219734,
		-0.005085571128534,
		0.128801733543812,
		0.295286916316708,
		0.227557747071651,
		0.572093690538583,
		0.550362521005818,
		0.713852301364139,
		0.496393535097141,
		0.4606219607891,
		0.275263658355144,
		0.404819081677315,
		0.199657357709264,
		0.065775793268841,
		-0.007198787851739,
		-0.039892097214393,
		-0.051893445388945)

Cm <- c(0.318114923064384,
		0.848856748466581,
		1.44773850101221,
		1.86825578174875,
		1.97103867196707,
		1.79272125604396,
		1.60479641334903,
		1.51754233200073,
		2.06793663104964,
		1.99845162067926,
		1.67273520995365,
		2.05560652012751,
		1.7272844642938,
		1.17412773519455,
		0.564811399573812,
		0.033205465741358,
		0.279569858997767)

clean <- data.frame(aoa, Cl, Cd, Cm)

# slat
aoa <- c(-4.15653027620116,
		 0.227624069165002,
		 4.51393618147022,
		 8.8218026340531,
		 13.3342031177816,
		 17.4917585639422,
		 21.4292209289379,
		 25.2621135029845,
		 29.3475816172249,
		 27.3886849757582,
		 23.3502985321255,
		 19.4124911364498,
		 15.4408648706553,
		 11.1837117580716,
		 6.75829098320419,
		 2.40822152977891,
		 -1.97034318096042,
		 -6.36053157317907,
		 -4.15250723558062)

Cl <- c(-0.092076633059504,
		0.133896511273531,
		0.302315400864837,
		0.483413314148882,
		0.784825363400919,
		0.877505037613072,
		0.840718193492892,
		0.742419707637934,
		0.792695068955815,
		0.816873515151906,
		0.794293254191462,
		0.830877139088094,
		0.847567570973684,
		0.696301034159789,
		0.446053519531878,
		0.240130311634655,
		0.017445187670344,
		-0.21207739598769,
		-0.089710138576833)

Cd <- c(-0.13187326331978,
		-0.069381398459438,
		-0.030596840992912,
		0.159152209018936,
		0.347900534672944,
		0.465934111060197,
		0.589573300347357,
		0.500016123544846,
		0.680597227951872,
		0.47196769858605,
		0.372952154346761,
		0.393979556954204,
		0.373023566791823,
		0.183348145145419,
		0.03859789853761,
		-0.023944680339046,
		-0.12313778767314,
		-0.12985780995894,
		-0.128091671295066)

Cm <- c(-0.046893855238801,
		0.216830580819281,
		0.43268347886209,
		0.59722569613552,
		0.95555391408457,
		1.06384782452082,
		0.978021890296141,
		0.906401585019699,
		0.929973042312658,
		1.05670017965936,
		1.03788517765293,
		1.04941507749727,
		1.05146661510981,
		0.901618243102533,
		0.601829564146293,
		0.338598532306693,
		0.090498576481465,
		-0.198990643594208,
		-0.045906475703096)

slat <- data.frame(aoa, Cl, Cd, Cm)

# flap 45
aoa <- c(-2.44393006511182,
		 2.14715518056511,
		 6.62577219187749,
		 10.9441647931601,
		 14.6828210727218,
		 18.3018262710352,
		 22.381130700811,
		 26.5519407439624,
		 30.6398196296368,
		 28.6327195210572,
		 24.5086485024714,
		 20.335692370876,
		 16.3811547027373,
		 12.7109477772822,
		 8.86958275327842,
		 4.45771858014289,
		 -0.052034600923551,
		 -4.72400221014736,
		 -2.3927303219227)

Cl <- c(0.915335255816574,
		1.26303245915595,
		1.544571877575,
		1.73186164303533,
		1.57813004277751,
		1.3540154535501,
		1.4006651181241,
		1.50114161409554,
		1.55283507625696,
		1.54865854179837,
		1.47567558968907,
		1.37393668875062,
		1.40067923690431,
		1.59467516310719,
		1.68798985486966,
		1.44571681184876,
		1.14586199945673,
		0.750586935207437,
		0.945452751810179)

Cd <- c(-0.265986322841976,
		-0.115042887152253,
		0.121690207261164,
		0.434582325284776,
		0.397223705216084,
		0.324750798224004,
		0.344255713960308,
		0.451177810332032,
		0.606008014363956,
		0.522096871905287,
		0.396424801302208,
		0.252555888131507,
		0.228191113006797,
		0.294975606999477,
		0.27047374561815,
		0.014202257321932,
		-0.181284993617867,
		-0.281522520399049,
		-0.255142482885909)

Cm <- c(1.34308853200126,
		1.77184114936121,
		2.08890381655713,
		2.25006225642126,
		2.10741711853182,
		1.86514136304558,
		1.98102002699638,
		2.1414433276605,
		2.20725422808838,
		2.211926718187,
		2.10002286255995,
		1.96130654896719,
		1.96160403920642,
		2.15715183287928,
		2.24353394871608,
		1.98001851268741,
		1.62522411537024,
		1.11877199909476,
		1.37703831716759)

flap <- data.frame(aoa, Cl, Cd, Cm)

#slat and flap
aoa <- c(-2.41051774874469,
		 2.07075744257306,
		 6.56856650095481,
		 10.9378759885876,
		 14.9203103004736,
		 18.7981341340449,
		 22.5948832497899,
		 26.6411150780389,
		 30.7344008206709,
		 28.7401363257107,
		 24.6874950111032,
		 20.5307565948183,
		 16.7875634947835,
		 12.7464150711611,
		 8.85583458992956,
		 4.36986536387378,
		 -0.171960582270663,
		 -4.78223564457707,
		 -2.3995973526321)

Cl <- c(0.93498955956195,
		1.21809261327827,
		1.51092147114989,
		1.72816234622799,
		1.71782958851388,
		1.64596125532053,
		1.52640191164112,
		1.55359710472877,
		1.60847107098288,
		1.6118448974769,
		1.58087941829603,
		1.48868034989314,
		1.6397432322256,
		1.61553827715361,
		1.67990269995857,
		1.39403844933752,
		1.07531730454667,
		0.716331973778193,
		0.941413321981119)

Cd <- c(-0.344125408010827,
		-0.207767647646963,
		0.061289281972896,
		0.361313271002801,
		0.603176036055367,
		0.61047793038835,
		0.794466921189104,
		0.718270007289836,
		0.872377442245428,
		0.740925591097372,
		0.558753108498088,
		0.29448734783472,
		0.385158389708245,
		0.246642504355259,
		0.194776016074831,
		-0.078951565009627,
		-0.279501328540585,
		-0.361564686394275,
		-0.341492229568796)

Cm <- c(1.41181070762658,
		1.76121077515699,
		2.07444257714221,
		2.28501333289695,
		2.2044562486102,
		2.15846349041306,
		1.93905120810072,
		2.08691530087804,
		2.16402545895829,
		2.20242460042808,
		2.18184941624468,
		2.11667449856012,
		2.23857239758997,
		2.21460642626697,
		2.27362759123975,
		1.95917017704773,
		1.58395923220114,
		1.1177904337362,
		1.41887846244122)

flapandslat <- data.frame(aoa, Cl, Cd, Cm)

#### Cl plot
coloursMap <- c("Clean" = "#3734eb", "Slat" = "#34b7eb", "Flap" = "#34ebc9", "Flap and Slat" = "#7a34eb")

pl1 <- ggplot() +
	geom_line(data = clean, aes(x = aoa, y = Cl, colour = "Clean"), size=1.5) + 
	geom_line(data = slat, aes(x = aoa, y = Cl, colour = "Slat"), size=1.5) + 
	geom_line(data = flap, aes(x = aoa, y = Cl, colour = "Flap"), size=1.5) +
	geom_line(data = flapandslat, aes(x = aoa, y = Cl, colour = "Flap and Slat"), size=1.5) +
	xlab(expression(alpha)) +
	ylab(expression(C[l])) +
	scale_colour_manual(values = coloursMap) + 
	theme_bw() +
	theme(axis.title.y = element_text(angle = 0, vjust = 0.5, size = 12),
		  axis.title.x = element_text(size = 15),
		  legend.position = c(.95, .25),
		  legend.justification = c("right", "top"),
		  legend.box.just = "right",
		  legend.margin = margin(6, 6, 6, 6),
		  legend.box.background = element_rect(color="black", size=1))
print(pl1)

#### Cd plot
coloursMap <- c("Clean" = "#3734eb", "Slat" = "#34b7eb", "Flap" = "#34ebc9", "Flap and Slat" = "#7a34eb")

pl2 <- ggplot() +
	geom_line(data = clean, aes(x = aoa, y = Cd, colour = "Clean"), size=1.5) + 
	geom_line(data = slat, aes(x = aoa, y = Cd, colour = "Slat"), size=1.5) + 
	geom_line(data = flap, aes(x = aoa, y = Cd, colour = "Flap"), size=1.5) +
	geom_line(data = flapandslat, aes(x = aoa, y = Cd, colour = "Flap and Slat"), size=1.5) +
	xlab(expression(alpha)) +
	ylab(expression(C[d])) +
	scale_colour_manual(values = coloursMap) + 
	theme_bw() +
	theme(axis.title.y = element_text(angle = 0, vjust = 0.5, size = 12),
		  axis.title.x = element_text(size = 15),
		  legend.position = c(.95, .25),
		  legend.justification = c("right", "top"),
		  legend.box.just = "right",
		  legend.margin = margin(6, 6, 6, 6),
		  legend.box.background = element_rect(color="black", size=1))
print(pl2)

#### Cm
coloursMap <- c("Clean" = "#3734eb", "Slat" = "#34b7eb", "Flap" = "#34ebc9", "Flap and Slat" = "#7a34eb")

pl3 <- ggplot() +
	geom_line(data = clean, aes(x = aoa, y = Cm, colour = "Clean"), size=1.5) + 
	geom_line(data = slat, aes(x = aoa, y = Cm, colour = "Slat"), size=1.5) + 
	geom_line(data = flap, aes(x = aoa, y = Cm, colour = "Flap"), size=1.5) +
	geom_line(data = flapandslat, aes(x = aoa, y = Cm, colour = "Flap and Slat"), size=1.5) +
	xlab(expression(alpha)) +
	ylab(expression(C[m])) +
	scale_colour_manual(values = coloursMap) + 
	theme_bw() +
	theme(axis.title.y = element_text(angle = 0, vjust = 0.5, size = 12),
		  axis.title.x = element_text(size = 15),
		  legend.position = c(.95, .25),
		  legend.justification = c("right", "top"),
		  legend.box.just = "right",
		  legend.margin = margin(6, 6, 6, 6),
		  legend.box.background = element_rect(color="black", size=1))
print(pl3)

